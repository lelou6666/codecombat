extends /templates/base-flat

block page_nav
  include ./teacher-dashboard-nav.jade

block content
<<<<<<< HEAD
  .container
    h3(data-i18n="TODO")
      | Current Classes
  
  .classes.container
    // Loop each class
    each classroom in view.classrooms.models
      unless classroom.get('archived')
        +classRow(classroom)
  
  +createClassButton
  
  .container
    h3(data-i18n="TODO")
      | Archived Classes
    h4(data-i18n="TODO")
      | Classes can be archived for future reference. Unarchive a class to view it in the Current Classes list again.

  .classes.container
    each classroom in view.classrooms.models
      if classroom.get('archived')
=======
  if !me.isTeacher() && !view.classrooms.size()
    .access-restricted.container.text-center.m-y-3
      h5(data-i18n='teacher.access_restricted')
      p(data-i18n='teacher.teacher_account_required')
      if me.isAnonymous()
        .login-button.btn.btn-lg.btn-primary(data-i18n='login.log_in')
        a.btn.btn-lg.btn-primary-alt(href="/teachers/signup" data-i18n='teacher.create_teacher_account')
      else
        a.btn.btn-lg.btn-primary(href="/teachers/update-account" data-i18n="teachers_quote.convert_account_title")
        button#logout-button.btn.btn-lg.btn-primary-alt(data-i18n="login.log_out")
        
    .teacher-account-blurb.text-center.col-xs-6.col-xs-offset-3.m-y-3
      h5(data-i18n='teacher.what_is_a_teacher_account')
      p(data-i18n='teacher.teacher_account_explanation')
    
  else
    if !me.isTeacher()
      .alert.alert-danger.text-center
        .container
          // DNT: Temporary
          h3 ATTENTION: Please upgrade your account to a Teacher Account.
          p
            | We are transitioning to a new improved classroom management system for instructors.
            | Please convert your account to ensure you retain access to your classrooms. 
          a.btn.btn-primary.btn-lg(href="/teachers/update-account") Upgrade to teacher account
      
    .container
      h3(data-i18n='teacher.current_classes')
    
    .classes.container
      // Loop each class
      each classroom in view.classrooms.models
        unless classroom.get('archived')
          +classRow(classroom)
    
    +createClassButton
  
  - var archivedClassrooms = view.classrooms.where({archived: true});
  if _.size(archivedClassrooms)
    .container
      h3(data-i18n='teacher.archived_classes')
      p(data-i18n='teacher.archived_classes_blurb')
  
    .classes.container
      each classroom in archivedClassrooms
>>>>>>> refs/remotes/codecombat/master
        +archivedClassRow(classroom)
      
mixin classRow(classroom)
  .class.row
    .col-xs-6
<<<<<<< HEAD
      .text-h2.semibold
        = classroom.get('name')
      .language.small
        span(data-i18n="TODO")
          | Language:
        &nbsp;
        span.language-name
          = classroom.capitalLanguage
      .student-count.small
        span(data-i18n="TODO")
          | Students:
        &nbsp;
        span
          = classroom.get('members').length
      .class-links
        a.text-h6(data-i18n="TODO" href=("/teachers/classes/" + classroom.id))
          | view class
        a.edit-classroom.text-h6(data-i18n="TODO" data-classroom-id=classroom.id)
          | edit class settings
        a.archive-classroom.text-h6(data-i18n="TODO" data-classroom-id=classroom.id)
          | archive class
        if classroom.get('archived')
          span
            | (archived)
=======
      .text-h4.semibold
        = classroom.get('name')
      .language.small
        span(data-i18n='teacher.language')
        | :&nbsp;
        span.language-name
          = classroom.capitalLanguage
      .student-count.small
        span(data-i18n='teacher.students')
        | :&nbsp;
        span
          = classroom.get('members').length
      .class-links
        a.text-h6(data-i18n='teacher.view_class' href=('/teachers/classes/' + classroom.id))
        a.edit-classroom.text-h6(data-i18n='teacher.edit_class_settings' data-classroom-id=classroom.id)
        a.archive-classroom.text-h6(data-i18n='teacher.archive_class' data-classroom-id=classroom.id)

>>>>>>> refs/remotes/codecombat/master
    .progress-col.col-xs-5
      if classroom.get('members').length == 0
        +addStudentsButton(classroom)
      else
        each course, index in view.courses.models
          +progressDot(classroom, course, index)
    .view-class-arrow.col-xs-1
<<<<<<< HEAD
      a.view-class-arrow-inner.glyphicon.glyphicon-chevron-right(data-classroom-id=classroom.id)
=======
      a.view-class-arrow-inner.glyphicon.glyphicon-chevron-right(data-classroom-id=classroom.id, href=('/teachers/classes/' + classroom.id))
>>>>>>> refs/remotes/codecombat/master


mixin addStudentsButton(classroom)
  .add-students
    .text-center
<<<<<<< HEAD
      div.small-details
        | This class has no students yet.
      a.add-students-button.btn.btn-lg.btn-primary(data-classroom-id=classroom.id)
        | Add Students
=======
      div.small-details(data-i18n='teacher.no_students_yet')
        | This class has no students yet.
      a.add-students-btn.btn.btn-lg.btn-primary(data-classroom-id=classroom.id )
        span(data-i18n='teacher.add_students')
          | Add Students
>>>>>>> refs/remotes/codecombat/master
        
mixin createClassButton
  .create-class
    .text-center
<<<<<<< HEAD
      a.create-classroom-button.btn.btn-lg.btn-primary
=======
      a.create-classroom-btn.btn.btn-lg.btn-primary(data-i18n='teacher.create_new_class')
>>>>>>> refs/remotes/codecombat/master
        | Create a New Class

mixin progressDot(classroom, course, index)
  //- TODO: Give classes abbreviations instead of using index?
  //- TODO: inefficient. Cache this in the view?
<<<<<<< HEAD
  - courseInstance = view.courseInstances.getByCourseAndClassroom(course, classroom)
  - var total = classroom.get('members').length
  - var complete = 0;
  - var dotClass = '';
  if courseInstance
    - complete = courseInstance.numCompleted
    - dotClass = complete === total ? 'forest' : 'gold';
=======
  - courseInstance = view.courseInstances.findWhere({ courseID: course.id, classroomID: classroom.id })
  - var total = classroom.get('members').length
  - var complete = 0;
  - var dotClass = '';
  - var started = 0;
  if courseInstance
    - complete = courseInstance.numCompleted
    - started = courseInstance.numStarted
    - dotClass = complete === total ? 'forest' : started ? 'gold' : '';
>>>>>>> refs/remotes/codecombat/master
  - var progressDotContext = {total: total, complete: complete}; 
  .progress-dot(class=dotClass, data-title=view.progressDotTemplate(progressDotContext))
    +progressDotLabel(index)

mixin progressDotLabel(index)
  .dot-label
    .text-h6
      | CS
      span
        = index + 1

<<<<<<< HEAD
mixin progressDotHoverInfo(total, complete)
  - var percentage = complete/total * 100
  - var className = (total > complete ? 'navy' : (total > 0 ? 'forest' : ''))
  .hover-info
    .hover-inside.text-center(class=className)
      .fraction-students.small-details
        = complete
        | /
        = total
        span(data-i18n="TODO")
          | &nbsp;Students
      .percent-students.small-details
        = percentage
        | %
        span(data-i18n="TODO")
          | &nbsp;Complete

mixin progressDotHoverInfoNoProgress(total, complete)
  .hover-info
    .hover-inside.text-center
      span.small-details(data-i18n="TODO")
        | No Progress
        
mixin archivedClassRow(classroom)
  .class.row
    span
      = classroom.get('name')
    .class-links
      a.unarchive-classroom.text-h6(data-i18n="TODO" data-classroom-id=classroom.id)
        | unarchive class
=======
mixin archivedClassRow(classroom)
  .class.row
    .col-xs-10
      span
        = classroom.get('name')
    .col-xs-2
      .class-links.pull-right
        a.unarchive-classroom.text-h6(data-i18n='teacher.unarchive_class' data-classroom-id=classroom.id)
>>>>>>> refs/remotes/codecombat/master
